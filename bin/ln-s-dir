#! /bin/bash

# ln -s dir, resolves relative paths and makes
# link folder exist before hand

function help_me() {
    echo -e "Usage: ln-s-dir <link-location> <target-location> <other ln args>\n"
}

if [[ $# -lt 2 ]]; then
	  echo "Not enough arguments passed"
	  help_me
	  return
fi

orig_dir="$(pwd)"

link="$1"
dir="$(dirname $link)"
file="$(basename $link)"
abs_link="$dir/$file"

mkdir -p "$dir"

target="$(readlink -f $2)"

ln -s "${@:3}" "$abs_link" "$target" \
   || echo link failed, probably already exsists
